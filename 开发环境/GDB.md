# GDB 调试工具常用命令笔记

## 目录
1. [启动与退出](#启动与退出)
2. [断点管理](#断点管理)
3. [执行控制](#执行控制)
4. [查看代码与变量](#查看代码与变量)
5. [堆栈与调用跟踪](#堆栈与调用跟踪)
6. [内存与寄存器操作](#内存与寄存器操作)
7. [多线程调试](#多线程调试)
8. [高级技巧](#高级技巧)
9. [常见问题](#常见问题)

---

## 启动与退出
| 命令 | 说明 | 示例 |
|------|------|------|
| `gdb <程序名>` | 启动调试会话 | `gdb ./demo` |
| `run [参数]` (`r`) | 运行程序（可传递参数） | `run arg1 arg2` |
| `quit` (`q`) | 退出 GDB | - |

---

## 断点管理
| 命令 | 说明 | 示例 |
|------|------|------|
| `break <位置>` (`b`) | 设置断点（函数/行号/文件:行号） | `b main`<br>`b file.c:10` |
| `info breakpoints` (`i b`) | 列出所有断点 | - |
| `delete <编号>` (`d`) | 删除断点 | `d 2` |
| `disable/enable <编号>` | 禁用/启用断点 | `enable 1` |
| `watch <表达式>` | 设置观察点（变量修改时暂停） | `watch x` |

---

## 执行控制
| 命令 | 说明 | 示例 |
|------|------|------|
| `next` (`n`) | 单步执行（不进入函数） | - |
| `step` (`s`) | 单步进入函数 | - |
| `continue` (`c`) | 继续运行到下一个断点 | - |
| `finish` | 执行完当前函数并暂停 | - |
| `until <行号>` | 运行到指定行（快速跳出循环） | `until 20` |

---

## 查看代码与变量
| 命令 | 说明 | 示例 |
|------|------|------|
| `list` (`l`) | 显示当前代码（默认 10 行） | `l 15`（显示第15行周围代码）|
| `print <变量>` (`p`) | 打印变量/表达式值 | `p *ptr` |
| `display <变量>` | 每次暂停自动显示变量 | `display x` |
| `info locals` | 查看当前函数局部变量 | - |
| `info args` | 查看函数参数 | - |

---

## 堆栈与调用跟踪
| 命令 | 说明 | 示例 |
|------|------|------|
| `backtrace` (`bt`) | 显示调用堆栈（定位崩溃点） | - |
| `frame <编号>` (`f`) | 切换堆栈帧 | `f 2` |
| `up/down` | 在堆栈帧间移动 | - |

---

## 内存与寄存器操作
| 命令 | 说明 | 示例 |
|------|------|------|
| `x/<格式> <地址>` | 检查内存内容 | `x/4xw 0x7ffffff`<br>（查看4个十六进制字） |
| `info registers` | 显示寄存器值 | - |
| `set var <变量>=<值>` | 修改变量值 | `set var x=5` |

---

## 多线程调试
| 命令 | 说明 | 示例 |
|------|------|------|
| `info threads` | 查看所有线程 | - |
| `thread <ID>` | 切换线程 | `thread 3` |
| `set scheduler-locking on` | 锁定当前线程（禁止线程切换） | - |

---

## 高级技巧
### 1. 条件断点
```gdb
break main if argc > 1  # 当参数数量大于1时在main函数暂停